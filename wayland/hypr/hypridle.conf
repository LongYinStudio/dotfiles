# ~/.config/hypr/hypridle.conf
# ----------------------------
# Hyprland ç©ºé—²è¡Œä¸ºç®¡ç†å·¥å…· 
# ----------------------------

# ----------------------
# å¸¸è§„è®¾ç½®
# ----------------------
general {
  lock_cmd = "hyprlock"                  # é”å±å‘½ä»¤ï¼ˆéœ€å®‰è£… hyprlockï¼‰
  unlock_cmd = "notify-send 'ðŸ”“ å·²è§£é”'"   # ç”¨æˆ·æ¢å¤æ“ä½œæ—¶çš„æç¤º
  before_sleep_cmd = "hyprlock && loginctl lock-session"  # ç³»ç»Ÿä¼‘çœ å‰å¼ºåˆ¶é”å±
  ignore_dbus_inhibit = false            # æ˜¯å¦å¿½ç•¥åº”ç”¨é˜»æ­¢ä¼‘çœ ï¼ˆå¦‚æ’­æ”¾è§†é¢‘æ—¶ï¼‰
}

# ----------------------
# åˆ†é˜¶æ®µé…ç½®
# ----------------------

# é˜¶æ®µ 1: ç©ºé—² 3 åˆ†é’Ÿ - é™ä½Žäº®åº¦å¹¶æš‚åœåª’ä½“
listener {
  timeout = 180  # 3 åˆ†é’Ÿ (å•ä½: ç§’)
  on-timeout = brightnessctl -q set 1% && playerctl pause && notify-send 'ðŸ’¤ è¿›å…¥èŠ‚èƒ½æ¨¡å¼' --icon=emblem-synchronizing
  on-resume = brightnessctl -q set 26% && notify-send 'âš¡ æ¢å¤æ´»åŠ¨' --icon=emblem-symbolic-link
}

# é˜¶æ®µ 2: ç©ºé—² 5 åˆ†é’Ÿ - å…³é—­æ˜¾ç¤ºå™¨
listener {
  timeout = 300
  on-timeout = "bash -c 'if hyprctl monitors | grep -q HDMI-A-1; then hyprctl dispatch dpms off HDMI-A-1; fi && hyprctl dispatch dpms off eDP-1'"
  on-resume = "hyprctl dispatch dpms on"
}

# é˜¶æ®µ 3: ç©ºé—² 10 åˆ†é’Ÿ - é”å±
listener {
  timeout = 600
  on-timeout = "hyprlock --immediate"     # ç«‹å³é”å±ï¼ˆè·³è¿‡åŠ¨ç”»ï¼‰
}

# é˜¶æ®µ 4: ç©ºé—² 30 åˆ†é’Ÿ - æŒ‚èµ·ç³»ç»Ÿï¼ˆä»…ç”µæ± æ¨¡å¼ï¼‰
listener {
  timeout = 1800
  on-timeout = "bash -c 'if [ $(cat /sys/class/power_supply/BAT0/status) = \"Discharging\" ]; then systemctl suspend && notify-send \"ðŸ”‹ å·²æŒ‚èµ·ï¼ˆç”µæ± æ¨¡å¼ï¼‰\"; else notify-send \"ðŸ”Œ ä¿æŒå”¤é†’ï¼ˆç”µæºé€‚é…å™¨æ¨¡å¼ï¼‰\"; fi'"
}

# ----------------------
# é«˜çº§é…ç½®
# ----------------------

# # æ¸¸æˆ/å…¨å±æ—¶ç¦ç”¨ç©ºé—²æ“ä½œ
# listener {
#   timeout = 1  # æ¯ 1 ç§’æ£€æŸ¥ä¸€æ¬¡
#   on-timeout = "bash -c 'active_window=$(hyprctl activewindow -j | jq -r \".class\"); if [[ $active_window =~ \"steam\"|\"gamescope\" ]]; then hypridle --pause && notify-send \"ðŸŽ® æ¸¸æˆæ¨¡å¼\" \"å·²ç¦ç”¨è‡ªåŠ¨é”å±å’Œä¼‘çœ \"; else hypridle --resume; fi'"
# }

# é”™è¯¯å¤„ç†ï¼ˆæ—¥å¿—è®°å½•ï¼‰
listener {
  timeout = 3600  # æ¯å°æ—¶æ¸…ç†ä¸€æ¬¡æ—¥å¿—
  on-timeout = journalctl -u hypridle --since '1 hour ago' > ~/.hypridle.log && echo '[$(date)] æ—¥å¿—å·²å½’æ¡£' >> ~/.hypridle.log
}

# æŸ¥çœ‹å®žæ—¶æ—¥å¿—
# tail -f ~/.hypridle.log
